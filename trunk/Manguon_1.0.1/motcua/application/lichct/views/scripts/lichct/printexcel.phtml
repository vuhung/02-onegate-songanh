<html xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:x="urn:schemas-microsoft-com:office:excel"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=utf-8">
<meta name=ProgId content=Excel.Sheet>
<meta name=Generator content="Microsoft Excel 11">
<link rel=File-List href="detail_files/filelist.xml">
<style id="Book1_2320_Styles">
<!--table
	{mso-displayed-decimal-separator:"\.";
	mso-displayed-thousand-separator:"\,";}
.xl152320
	{padding-top:1px;
	padding-right:1px;
	padding-left:1px;
	mso-ignore:padding;
	color:windowtext;
	font-size:10.0pt;
	font-weight:400;
	font-style:normal;
	text-decoration:none;
	font-family:Arial;
	mso-generic-font-family:auto;
	mso-font-charset:0;
	mso-number-format:General;
	text-align:general;
	vertical-align:center;
	mso-background-source:auto;
	mso-pattern:auto;
	white-space:nowrap;}
.xl222320
	{padding-top:1px;
	padding-right:1px;
	padding-left:1px;
	mso-ignore:padding;
	color:windowtext;
	font-size:14.0pt;
	font-weight:700;
	font-style:normal;
	text-decoration:none;
	font-family:"Times New Roman", serif;
	mso-font-charset:0;
	mso-number-format:General;
	text-align:center;
	vertical-align:center;
	border:.5pt solid windowtext;
	mso-background-source:auto;
	mso-pattern:auto;
	white-space:nowrap;}
.xl232320
	{padding-top:1px;
	padding-right:1px;
	padding-left:1px;
	mso-ignore:padding;
	color:windowtext;
	font-size:10.0pt;
	font-weight:700;
	font-style:normal;
	text-decoration:none;
	font-family:Arial, sans-serif;
	mso-font-charset:0;
	mso-number-format:General;
	text-align:center;
	vertical-align:middle;
	border:.5pt solid windowtext;
	mso-background-source:auto;
	mso-pattern:auto;
	white-space:nowrap;}
.xl242320
	{padding-top:1px;
	padding-right:1px;
	padding-left:1px;
	mso-ignore:padding;
	color:windowtext;
	font-size:10.0pt;
	font-weight:400;
	font-style:normal;
	text-decoration:none;
	font-family:Arial;
	mso-generic-font-family:auto;
	mso-font-charset:0;
	mso-number-format:General;
	text-align:general;
	vertical-align:middle;
	border:.5pt solid windowtext;
	mso-background-source:auto;
	mso-pattern:auto;
	white-space:nowrap;}
.xl252320
	{padding-top:1px;
	padding-right:1px;
	padding-left:1px;
	mso-ignore:padding;
	color:windowtext;
	font-size:10.0pt;
	font-weight:700;
	font-style:normal;
	text-decoration:none;
	font-family:Arial, sans-serif;
	mso-font-charset:0;
	mso-number-format:"\@";
	text-align:middle;
	vertical-align:middle;
	border:.5pt solid windowtext;
	mso-background-source:auto;
	mso-pattern:auto;
	white-space:nowrap;}
-->
</style>
</head>

<body>
<!--[if !excel]>&nbsp;&nbsp;<![endif]-->
<!--The following information was generated by Microsoft Office Excel's Publish
as Web Page wizard.-->
<!--If the same item is republished from Excel, all information between the DIV
tags will be replaced.-->
<!----------------------------->
<!--START OF OUTPUT FROM EXCEL PUBLISH AS WEB PAGE WIZARD -->
<!----------------------------->

<div id="Book1_2320" align=center x:publishsource="Excel">

<table x:str border=0 cellpadding=0 cellspacing=0 width=966 style='border-collapse:
 collapse;table-layout:fixed;width:724pt'>
 <col width=64 span=2 style='width:48pt'>
 <col width=423 style='mso-width-source:userset;mso-width-alt:15469;width:317pt'>
 <col width=179 style='mso-width-source:userset;mso-width-alt:6546;width:134pt'>
 <col width=236 style='mso-width-source:userset;mso-width-alt:8630;width:177pt'>
 <tr height=25 style='height:18.75pt'>
  <td colspan=2 height=25 class=xl222320 width=128 style='height:18.75pt;
  width:96pt'>Ngày tháng</td>
  <td class=xl222320 width=423 style='border-left:none;width:317pt'>N&#7897;i
  dung</td>
  <td class=xl222320 width=179 style='border-left:none;width:134pt'>&#272;&#7883;a
  &#273;i&#7875;m</td>
  <td class=xl222320 width=236 style='border-left:none;width:177pt'>Thành
  ph&#7847;n</td>
 </tr>
<?php
	function countbuoi($data1,$posdata1,$data2,$buoi,$currentdate){
		//dem data1 neu gio bat dau trong buoi sdang (<12h)
		$indate = 0;
		$alldate = 0;
		for($i=0;$i<count($data1[$posdata1]);$i++){
			$begintime = getdate(strtotime($data1[$posdata1][$i]['BEGINTIME']));
			$endtime = getdate(strtotime($data1[$posdata1][$i]['ENDTIME']));
			if($buoi==1 && $begintime['hours']<12){
				$indate++;
			}else if($buoi==2 && $begintime['hours']>=12){
				$indate++;
			}else if($buoi==1 && $endtime['hours']<12){
				$indate++;
			}else if($buoi==2 && $endtime['hours']>=12){
				$indate++;
			}
		}
		for($i=0;$i<count($data2);$i++){
			//check ngay dang chon so voi ngay trong list
			$begintime = date("Y-m-d",strtotime($data2[$i]['BEGINTIME']));
			$endtime = date("Y-m-d",strtotime($data2[$i]['ENDTIME']));
			$currentdate = date("Y-m-d",$currentdate);
			//neu ngay hien tai = ngay bat dau
			$ok=true;
			if($currentdate==$begintime){
				$begintime = getdate(strtotime($data2[$i]['BEGINTIME']));
				$endtime = getdate(strtotime($currentdate." 23:59:59"));
			}else if($currentdate>$begintime && $currentdate<$endtime){
				$begintime = getdate(strtotime($currentdate." 00:00:00"));
				$endtime = getdate(strtotime($currentdate." 23:59:59"));
			}else if($currentdate==$endtime){
				$begintime = getdate(strtotime($currentdate." 00:00:00"));
				$endtime = getdate(strtotime($data2[$i]['ENDTIME']));
			}else{
				$ok=false;
			}
			if($ok){
				if($buoi==1 && $begintime['hours']<12){
					$indate++;
				}else if($buoi==2 && $begintime['hours']>=12){
					$indate++;
				}else if($buoi==1 && $endtime['hours']<12){
					$indate++;
				}else if($buoi==2 && $endtime['hours']>=12){
					$indate++;
				}
			}
			//$alldate++;
		}
		if($indate==0){
			return 1;
		}
		return $indate;
	}
	function getbuoi($data1,$posdata1,$data2,$buoi,$currentdate){
		//dem data1 neu gio bat dau trong buoi sdang (<12h)
		$indate = array();
		for($i=0;$i<count($data1[$posdata1]);$i++){
			$begintime = getdate(strtotime($data1[$posdata1][$i]['BEGINTIME']));
			$endtime = getdate(strtotime($data1[$posdata1][$i]['ENDTIME']));
			if($buoi==1 && $begintime['hours']<12){
				$indate[]['CONTENT'] = $data1[$posdata1][$i]['CONTENT'];
				$indate[count($indate)-1]['THANHPHAN'] = $data1[$posdata1][$i]['THANHPHAN'];
				$indate[count($indate)-1]['DIADIEM'] = $data1[$posdata1][$i]['DIADIEM'];
			}else if($buoi==2 && $begintime['hours']>=12){
				$indate[]['CONTENT'] = $data1[$posdata1][$i]['CONTENT'];
				$indate[count($indate)-1]['THANHPHAN'] = $data1[$posdata1][$i]['THANHPHAN'];
				$indate[count($indate)-1]['DIADIEM'] = $data1[$posdata1][$i]['DIADIEM'];
			}else if($buoi==1 && $endtime['hours']<12){
				$indate[]['CONTENT'] = $data1[$posdata1][$i]['CONTENT'];
				$indate[count($indate)-1]['THANHPHAN'] = $data1[$posdata1][$i]['THANHPHAN'];
				$indate[count($indate)-1]['DIADIEM'] = $data1[$posdata1][$i]['DIADIEM'];
			}else if($buoi==2 && $endtime['hours']>=12){
				$indate[]['CONTENT'] = $data1[$posdata1][$i]['CONTENT'];
				$indate[count($indate)-1]['THANHPHAN'] = $data1[$posdata1][$i]['THANHPHAN'];
				$indate[count($indate)-1]['DIADIEM'] = $data1[$posdata1][$i]['DIADIEM'];
			}
		}
		for($i=0;$i<count($data2);$i++){
		//check ngay dang chon so voi ngay trong list
			$begintime = date("Y-m-d",strtotime($data2[$i]['BEGINTIME']));
			$endtime = date("Y-m-d",strtotime($data2[$i]['ENDTIME']));
			$currentdate = date("Y-m-d",$currentdate);
			//neu ngay hien tai = ngay bat dau
			$ok=true;
			if($currentdate==$begintime){
				$begintime = getdate(strtotime($data2[$i]['BEGINTIME']));
				$endtime = getdate(strtotime($currentdate." 23:59:59"));
			}else if($currentdate>$begintime && $currentdate<$endtime){
				$begintime = getdate(strtotime($currentdate." 00:00:00"));
				$endtime = getdate(strtotime($currentdate." 23:59:59"));
			}else if($currentdate==$endtime){
				$begintime = getdate(strtotime($currentdate." 00:00:00"));
				$endtime = getdate(strtotime($data2[$i]['ENDTIME']));
			}else{
				$ok=false;
			}
			if($ok){
				if($buoi==1 && $begintime['hours']<12){
					$indate[]['CONTENT'] = $data2[$i]['CONTENT'];
					$indate[count($indate)-1]['THANHPHAN'] = $data2[$i]['THANHPHAN'];
					$indate[count($indate)-1]['DIADIEM'] = $data2[$i]['DIADIEM'];
				}else if($buoi==2 && $begintime['hours']>=12){
					$indate[]['CONTENT'] = $data2[$i]['CONTENT'];
					$indate[count($indate)-1]['THANHPHAN'] = $data2[$i]['THANHPHAN'];
					$indate[count($indate)-1]['DIADIEM'] = $data2[$i]['DIADIEM'];
				}else if($buoi==1 && $endtime['hours']<12){
					$indate[]['CONTENT'] = $data2[$i]['CONTENT'];
					$indate[count($indate)-1]['THANHPHAN'] = $data2[$i]['THANHPHAN'];
					$indate[count($indate)-1]['DIADIEM'] = $data2[$i]['DIADIEM'];
				}else if($buoi==2 && $endtime['hours']>=12){
					$indate[]['CONTENT'] = $data2[$i]['CONTENT'];
					$indate[count($indate)-1]['THANHPHAN'] = $data2[$i]['THANHPHAN'];
					$indate[count($indate)-1]['DIADIEM'] = $data2[$i]['DIADIEM'];
				}
			}
		}
		if($indate==0 && $alldate==0){
			$indate[] = array();
		}
		return $indate;
	}
	for($i=0;$i<count($this->date);$i++){
		$onedate = $this->date[$i];
		$countsang = countbuoi($this->data,$i,$this->rangedate,1,$onedate);
		$countchieu = countbuoi($this->data,$i,$this->rangedate,2,$onedate);
		$sang = getbuoi($this->data,$i,$this->rangedate,1,$onedate);
		$chieu = getbuoi($this->data,$i,$this->rangedate,2,$onedate);
		$countall = $countsang+$countchieu;
		//var_dump($chieu);
?>
 <tr height=17 style='height:12.75pt'>
  <td rowspan=<?=$countall?> height=51 class=xl252320 style='height:38.25pt;border-top:none'><?=date("d/m",$onedate)?></td>
  <td class=xl232320 style='border-top:none;border-left:none' rowspan="<?=$countsang?>">S</td>
  <td class=xl242320 width=423 style='border-top:none;border-left:none;
  width:317pt'>&nbsp;<?=nl2br(htmlspecialchars($sang[0]["CONTENT"]))?></td>
  <td class=xl242320 width=179 style='border-top:none;border-left:none;
  width:134pt'>&nbsp;<?=nl2br(htmlspecialchars($sang[0]["DIADIEM"]))?></td>
  <td class=xl242320 width=236 style='border-top:none;border-left:none;
  width:177pt'>&nbsp;<?=nl2br(htmlspecialchars($sang[0]["THANHPHAN"]))?></td>
 </tr>
<?php
		for($j=1;$j<$countsang;$j++){
?>
 <tr height=17 style='height:12.75pt'>
  <td class=xl242320 width=423 style='border-top:none;border-left:none;
  width:317pt'>&nbsp;<?=nl2br(htmlspecialchars($sang[$j]["CONTENT"]))?></td>
  <td class=xl242320 width=179 style='border-top:none;border-left:none;
  width:134pt'>&nbsp;<?=nl2br(htmlspecialchars($sang[$j]["DIADIEM"]))?></td>
  <td class=xl242320 width=236 style='border-top:none;border-left:none;
  width:177pt'>&nbsp;<?=nl2br(htmlspecialchars($sang[$j]["THANHPHAN"]))?></td>
 </tr>
<?php
		}
?>
 <tr height=17 style='height:12.75pt'>
  <td height=17 class=xl232320 style='height:12.75pt;border-top:none;
  border-left:none' rowspan="<?=$countchieu?>">C</td>
  <td class=xl242320 width=423 style='border-top:none;border-left:none;
  width:317pt'>&nbsp;<?=nl2br(htmlspecialchars($chieu[0]["CONTENT"]))?></td>
  <td class=xl242320 width=179 style='border-top:none;border-left:none;
  width:134pt'>&nbsp;<?=nl2br(htmlspecialchars($chieu[0]["DIADIEM"]))?></td>
  <td class=xl242320 width=236 style='border-top:none;border-left:none;
  width:177pt'>&nbsp;<?=nl2br(htmlspecialchars($chieu[0]["THANHPHAN"]))?></td>
 </tr>
<?php
		for($j=1;$j<$countchieu;$j++){
?>
 <tr height=17 style='height:12.75pt'>
  <td class=xl242320 width=423 style='border-top:none;border-left:none;
  width:317pt'>&nbsp;<?=nl2br(htmlspecialchars($chieu[$j]["CONTENT"]))?></td>
  <td class=xl242320 width=179 style='border-top:none;border-left:none;
  width:134pt'>&nbsp;<?=nl2br(htmlspecialchars($chieu[$j]["DIADIEM"]))?></td>
  <td class=xl242320 width=236 style='border-top:none;border-left:none;
  width:177pt'>&nbsp;<?=nl2br(htmlspecialchars($chieu[$j]["THANHPHAN"]))?></td>
 </tr>
<?php
		}
?>
<?php
	}
?>
 <![if supportMisalignedColumns]>
 <tr height=0 style='display:none'>
  <td width=64 style='width:48pt'></td>
  <td width=64 style='width:48pt'></td>
  <td width=423 style='width:317pt'></td>
  <td width=179 style='width:134pt'></td>
  <td width=236 style='width:177pt'></td>
 </tr>
 <![endif]>
</table>

</div>


<!----------------------------->
<!--END OF OUTPUT FROM EXCEL PUBLISH AS WEB PAGE WIZARD-->
<!----------------------------->
</body>

</html>
